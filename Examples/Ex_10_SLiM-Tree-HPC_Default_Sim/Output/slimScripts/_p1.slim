initialize() {
	setSeed(256786975);
	initializeSLiMOptions(nucleotideBased=T);
	defineConstant("codons", c(14, 1, 55, 55, 34, 8, 24, 25, 28, 10, 12, 1, 10, 1, 0, 58, 28, 58, 51, 1, 2, 57, 12, 19, 15, 42, 2, 58, 9, 13, 16, 31, 27, 45, 18, 2, 41, 41, 36, 62, 19, 35, 9, 9, 4, 4, 38, 27, 40, 58, 53, 39, 58, 15, 14, 25, 1, 40, 28, 34, 38, 31, 20, 19, 55, 14, 42, 17, 0, 58, 40, 38, 22, 37, 51, 60, 18, 9, 54, 15, 38, 22, 29, 30, 33, 25, 3, 35, 61, 37, 29, 28, 5, 14, 41, 58, 61, 39, 17, 34, 38, 21, 35, 10, 58, 58, 63, 37, 63, 16, 58, 35, 38, 35, 20, 11, 7, 34, 63, 33, 49, 13, 39, 38, 51, 42, 13, 37, 38, 63, 51, 39, 14, 28, 63, 19, 58, 58, 30, 35, 38, 51, 63, 39, 52, 32, 38, 14, 28, 58, 5, 61, 33, 14, 32, 28, 58, 60, 38, 16, 41, 13, 31, 25, 37, 3, 25, 41, 63, 58, 4, 14, 58, 60, 1, 16, 13, 9, 0, 16, 11, 10, 53, 21, 23, 17, 39, 24, 32, 33, 52, 55, 32, 35, 58, 1, 34, 2, 59, 3, 1, 8, 51, 58, 37, 16, 53, 32, 25, 32, 19, 51, 36, 26, 29, 53, 7, 23, 49, 58, 18, 58, 43, 12, 60, 37, 6, 2, 37, 11, 3, 37, 20, 15, 49, 9, 58, 17, 4, 36, 35, 10, 8, 19, 37, 39, 34, 20, 60, 9, 17, 27, 61, 32, 37, 33, 41, 4, 59, 28, 58, 19, 3, 14, 46, 61, 3, 5, 18, 38, 62, 7, 58, 25, 33, 55, 37, 41, 35, 54, 58, 52, 39, 24, 22, 21, 32, 4, 4, 8, 39, 29, 18, 2, 58, 13, 44, 34, 58, 56));
	initializeAncestralNucleotides(codonsToNucleotides(codons, format="char"));
	mm = mmJukesCantor(8.333333333333334e-07);
	initializeMutationTypeNuc("m1", 0.5, "f", 0.0);
	m1.convertToSubstitution = F;
	initializeGenomicElementType("g1", m1, 1.0, mm);
	initializeGenomicElementType("g2", m1, 1.0, mm);
	initializeRecombinationRate(2.5e-08);
	initializeGenomicElement(g1, 0, 899);
}


function (void) setup_fitness(void){
	sim.setValue("A", c(0.9877266812468251, 0.9776161349642809, 0.983892134376715, 1.0, 0.8488377222592929, 0.981590046102542, 0.9946205999259509, 0.9898374496645258, 0.996333791969413, 0.987241377716614, 0.9861727511661121, 0.9856649186689781, 0.98227942302891, 0.991587573967498, 0.983254368772565, 0.9945786532605759, 1.0, 0.9953949882777241, 1.0, 0.996059247937639, 0.9900799634346941, 0.9943683618464391, 0.9932913675921209, 0.999262784868322, 0.994478820532166, 0.99581423392148, 0.993470284846506, 0.996953125393277, 0.994479192711096, 1.00173186544418, 0.995677024758145, 0.988184044237927, 0.995845119911837, 0.9949580609400479, 1.0, 0.990221441052182, 0.9889215081534721, 1.0, 0.9890708730925458, 0.990995951234592, 0.997289980496458, 1.0017495787436301, 1.0, 0.991240947756075, 0.9927621062367791, 0.990465857660693, 0.9914333107937321, 0.994793181854534, 0.9965159122533691, 1.0, 1.0));
	sim.setValue("C", c(0.8376530204088961, 0.839442229749347, 0.84168684990466, 0.988065578356162, 0.980983543321104, 0.8379031118710709, 0.987654237975734, 0.9877998354456601, 0.983254522761422, 0.8381236564064449, 0.986171405394839, 0.980144329355182, 0.9822795795768591, 0.84231570455164, 0.986737835724551, 0.836490186793575, 0.9889571347233291, 0.9873069965763679, 0.9886859139499009, 0.9897636481015719, 0.9854761924514119, 0.9897636797314809, 0.8392980022369421, 0.840591241963354, 0.840916737768157, 0.8401823032527141, 0.989986753418545, 0.9934698685898291, 0.986392237369136, 0.994765446990713, 0.839775497636192, 0.9847015628705941, 0.8419572490037769, 0.8407736908841121, 0.992878613559134, 0.839613968037096, 0.98431705195755, 1.00236117455181, 0.987950234523623, 0.986391891757351, 0.9909940357415509, 0.841372874293466, 0.840911797348274, 0.8400681464075319, 0.841378704285732, 0.986981852986049, 0.8405793882951759, 0.8388989262468091, 0.9944783872126551, 0.9905927194979041, 1.0));
	sim.setValue("D", c(0.996293270492131, 0.845582581515925, 0.846283206698977, 0.984581782611732, 0.8387065814145409, 1.0, 0.991137441154601, 0.98779983694409, 0.98325445806101, 0.9988120704115121, 0.84164217416779, 0.9801443162761079, 0.982279595768626, 1.0, 0.840167243032697, 0.9838241164267701, 0.9944783923830821, 0.9907904457214971, 0.99216935942185, 1.0008052213813001, 1.0, 0.989763682280335, 0.9949822236056469, 0.999999510456715, 1.00067055942988, 0.997505028591256, 0.9899867415556759, 0.993469868578869, 0.9953955067583621, 0.9912819566351802, 0.9926311395811009, 0.9916672077094041, 0.9965161305152741, 0.9933577822137329, 0.8394626235177879, 0.9948258585836801, 0.8411690802887009, 0.8389478641444421, 0.984467506844747, 0.9863918833840292, 0.9979609508586841, 1.00203679040371, 0.996271225025701, 0.9884291899115759, 0.9949823564915601, 0.842271897282196, 1.0, 0.996676040456743, 0.9909950919327621, 0.999596782680759, 1.0));
	sim.setValue("E", c(0.992331161751014, 0.8455825815096178, 0.846283206698571, 0.984582237092888, 0.8453267371890859, 0.992039482139875, 0.9876542356064131, 0.9912830557027701, 0.983254527736868, 1.0, 0.8416720251409658, 0.9836278437493471, 0.98227959568486, 0.999999523026644, 0.842314334840745, 0.987307663740658, 0.997961601417258, 0.9928279954276089, 0.9956525750126151, 0.9952845501239541, 0.9994079780022621, 0.9952845300041759, 1.0, 1.00274593544219, 1.0032375531478501, 1.0, 0.9969534291111709, 1.00043627717669, 0.9919123208056422, 0.991281925423282, 0.996114257025004, 0.9916672077073599, 1.00059117384583, 0.999280653863535, 0.985911213882003, 1.0, 0.8431841358678199, 0.8410790895528092, 0.9844675067805341, 0.9933577813025641, 0.996515259287734, 1.0020367903925, 1.0021162037612, 0.996995565530832, 0.99769096589749, 0.8439038801725559, 0.9989914981500259, 0.99600503118207, 0.9944783790035021, 1.0026426624020899, 1.0));
	sim.setValue("F", c(0.845094282463257, 0.977617443605289, 0.9928957644031858, 0.8418156995292779, 0.9996449610138841, 0.842379816775448, 0.8376629011677529, 0.8374005180165508, 0.8362294764391992, 0.8460802090878171, 0.993139192880328, 0.980144327846922, 0.9951685689372499, 0.84343762975394, 1.0038294509518801, 0.8366911411887191, 0.9889571904393509, 0.987307000504259, 0.8408147699204258, 0.839811273611494, 0.988958718906915, 0.9932469953322959, 0.98520451580555, 0.840559893872997, 0.842381916699711, 0.841644243040802, 0.9934702058204229, 1.00391942770642, 0.998878539086934, 0.996803054118692, 0.8407702674530629, 0.9847015629095699, 0.842132147808485, 0.986392217991935, 0.838291112570325, 0.839912564275592, 0.9822795888482149, 0.9907901468128472, 0.9999997391579549, 0.9863918914477241, 0.9944776736131992, 0.8422145507984279, 0.841535751356558, 0.84036452951486, 0.842541518060933, 1.00059109037818, 0.841942069832861, 0.8407265489561581, 0.999082850811912, 0.996113580392399, 1.0));
	sim.setValue("G", c(1.0, 0.8480466171051751, 0.8489082581473342, 0.9915486893056619, 0.846532547469938, 0.987110674993936, 0.9896918541436741, 0.987799913916266, 1.0, 0.9837581722648772, 0.845398689844453, 0.9766611666966399, 0.978796395908386, 0.989550038290205, 0.8442721458285899, 0.9858619997972401, 0.9909952395714959, 0.9838238438714629, 0.9980924479018101, 0.996730127854439, 0.9854755763039, 0.986280452307402, 0.981721345768335, 0.987949651909677, 0.9902211265376858, 0.9888479133278059, 0.843304425042146, 0.9899867142740708, 0.992686834361932, 0.9968030660782221, 0.9871104537964491, 0.9867384637861079, 0.989549780298546, 0.988429021374139, 0.987949805176951, 0.983255179431091, 0.9753142414059169, 0.991911736444048, 0.9809844671639051, 0.982908689300652, 0.9944777927673281, 1.00144493026791, 0.9902211420198409, 0.9814630308968991, 0.9898086167839091, 0.844900653631329, 0.9890715075444609, 0.9908310528239341, 0.987511975592195, 0.9940761077140821, 1.0));
	sim.setValue("H", c(0.9877264745051371, 0.8455527306889209, 0.845944615827636, 0.836620123616829, 0.9844668434349642, 0.98711065068327, 0.987654233980478, 0.9933207164083878, 0.8373422258874549, 0.981722471675438, 0.8377842025474821, 0.9801443349377379, 0.998454658660012, 0.991587571899452, 0.8418300856485021, 0.983824119145595, 0.992440819946303, 0.987307001287024, 0.9921693771562641, 0.9967302058370741, 0.992441762541104, 0.9932469895625741, 0.988687072115649, 0.9879492920334471, 0.988183046112442, 0.984243655100541, 0.9934702050659872, 1.00504075582122, 0.996841016662423, 0.991281955732693, 0.990593622206082, 1.0, 0.99507047725177, 0.99191214951366, 0.8433715689473241, 0.9867383308402191, 0.841233008081037, 0.9873065245974821, 0.991433447092894, 0.9898747265401, 0.9979609508588191, 0.990994811840121, 0.9881835392555159, 0.9904664903028192, 0.990724781529021, 0.98698185699085, 0.984468108596866, 0.986226396344448, 1.0007736884396898, 1.00104243471303, 1.0));
	sim.setValue("I", c(0.841548148955292, 0.994239865773688, 1.00275343217381, 0.8427453676569091, 0.978945444797, 0.8421439544105841, 0.9856166949214371, 0.9857623208635959, 0.839877315429458, 0.8426931196924781, 0.997397075951771, 0.9929029755236949, 0.9802420154481791, 0.8449007925698921, 0.9944791640245141, 0.9817866153955079, 0.993886545718118, 0.996311167352464, 0.8429391857866071, 0.9877261364152309, 0.9889586409971669, 0.9958140066783059, 0.992944677483826, 0.9859117075440071, 0.8436928578044829, 0.843108992509048, 1.0027458342870699, 0.998398764067682, 0.9843547246880999, 0.9982487021133621, 0.985072898004393, 0.9826641309317249, 0.987512105770429, 0.987837234511967, 0.9928786256447379, 0.9812180948760509, 0.991555001846897, 0.98526815448497, 0.9893958113995871, 0.995924727590088, 0.992440136085933, 0.9889572982373158, 0.986146031655295, 0.986391487934898, 0.844133786899068, 1.0, 0.8433502685731341, 0.8417668103955251, 0.9979615480004929, 0.988555206389897, 1.0));
	sim.setValue("K", c(0.992331159644011, 0.841790977433667, 0.842497951786877, 0.836565676651175, 0.845356948762258, 0.9850731667178171, 0.9876542356259391, 1.00521576731315, 0.8373184163364059, 0.987241325905791, 0.838997409121096, 0.980144326416004, 0.982279578838004, 0.9985538890064449, 0.842084269982004, 0.9873076637535321, 0.9970454084246229, 0.9907904441253109, 1.00025704869867, 0.9967302097221371, 0.9924417625461279, 1.00181360647061, 0.9949822279601501, 0.9934701931273492, 1.0002333042523501, 0.991209742905325, 0.996953435100297, 1.00391942770715, 0.989874866274677, 0.9912819126960601, 0.999999632148847, 0.9944793252180308, 1.00243904515039, 0.9953953143439379, 0.841115055697329, 0.9957420566464681, 0.8430786074461322, 0.839178674371489, 0.984467520622401, 1.0, 1.0020360301471098, 0.9965160886787081, 1.0010727830416501, 1.0, 1.0, 0.842234161237883, 0.9899877433156901, 0.994314254813671, 0.9965158975543571, 0.997559259179048, 1.0));
	sim.setValue("L", c(0.847763636984893, 0.9825449406580942, 1.0, 0.8477971018535819, 0.980983680133755, 0.848589074397468, 0.982133492280358, 0.985762398090428, 0.977733921581613, 0.8479000361240671, 1.0, 0.9850730131708841, 0.9822794141865779, 0.9805463852129079, 1.0, 0.9817869590596929, 0.9904034116201529, 0.993836405654458, 0.9866486875191329, 0.984242985952803, 0.988042376235934, 1.0, 0.987770737077523, 0.985912163919595, 0.9826622856236659, 0.978722988414597, 1.0, 1.0, 0.986391654065556, 1.0, 0.9871104750545, 0.9826633557278851, 0.984028912043573, 0.9933577945397629, 0.9859122920629608, 0.9812176663240891, 0.986884000101028, 0.9873070216319871, 0.990516974855919, 0.9906492129358141, 0.9952524701030501, 0.985474146511465, 0.986146059156825, 0.9863914857267471, 0.97968506427737, 0.996258316809903, 0.978947452571112, 0.980705752979478, 0.997045374575696, 0.9931599382869609, 1.0));
	sim.setValue("M", c(0.836214610253858, 0.984582532777661, 0.9978247720958571, 0.8386293660156942, 0.984466315163389, 0.8371298171115029, 0.99113741904635, 0.9912829869533158, 0.8353385971014758, 0.837206057008318, 1.0044522573721602, 0.990593718753945, 0.985762703989006, 0.8386922268674021, 0.999999742808532, 0.830820541978248, 0.995923970547837, 0.9942735773067101, 0.9921690783047651, 0.993246798187932, 0.9924418728025991, 1.00481781106621, 0.9886876701262471, 0.834874501295086, 0.8372952258545999, 0.8368713785002421, 1.0004365448602, 1.00247377609197, 0.9898754441602751, 1.00633638783717, 0.8336710649520509, 0.9881847962356151, 0.993032732188503, 0.9979622606458141, 0.99287852791341, 0.986739627709708, 0.987800202513503, 0.9942732931520709, 0.993470889549875, 0.993357911120712, 1.00144409499447, 0.835929564495646, 0.8348813736772489, 0.9884292952945191, 0.837570256708448, 0.9974321607308521, 0.8372694282425059, 0.8355740446977329, 1.00144464173643, 0.994075871512435, 1.0));
	sim.setValue("N", c(0.9971327401424721, 0.8414898392769079, 0.842336751493457, 0.984581782623888, 0.83875193319977, 0.997962356934471, 0.996658132500303, 0.9933207165692891, 0.983254449061818, 0.9886869444106141, 0.837974822681736, 0.983627404180444, 0.9892457122470399, 0.9993285040653381, 0.840066229495349, 0.98382412156167, 0.9959240550918279, 0.987307000744425, 0.9956525755003871, 1.00506302144215, 0.996516783894133, 0.993246989812948, 0.9886870897908442, 0.9914327516253578, 0.9937042365834979, 0.98976410989492, 0.9899867445985759, 0.9969531063813131, 0.9968410167999201, 0.994765445974104, 0.99059362245629, 0.9986335113014171, 0.999328280208797, 0.99191214990412, 0.8410868336317621, 0.9902214189879179, 0.8395560886037421, 0.9907900940754771, 0.984467520642525, 0.9898747265821509, 1.00203602751272, 0.9999992503290122, 0.993704239889864, 0.9884291899107459, 0.994982388281307, 0.8408293080575091, 0.99491648972159, 0.9943142548019129, 0.9999990439701021, 0.9961135803969219, 1.0));
	sim.setValue("P", c(0.980760749554956, 0.843555255976635, 0.8439805823477758, 0.984582371011379, 0.8474441552555301, 0.9781070641227719, 0.9876542910178759, 0.9843166857528091, 0.979771445216809, 0.9782378424499529, 0.840717375506539, 0.9766611749549201, 0.8409642551388841, 0.9825838800171011, 0.843400378877854, 1.0, 0.99099524105789, 1.0, 0.9852027657074599, 0.986280497712425, 0.981993040929227, 0.986280523868711, 0.9817213442200691, 1.0, 1.0, 0.9807604895508208, 0.986503600070741, 0.989986714289543, 0.988429161645384, 0.987798804133797, 1.0, 0.981218513971277, 0.986066427552533, 0.982908927003652, 0.9824273021497859, 0.8419156766948299, 0.9753142414067459, 0.9838231966134441, 0.9809844671668209, 0.982908690573578, 1.0, 0.9944786570887059, 0.988183583471718, 0.981463031395508, 0.981722652055805, 0.843729069365333, 0.987950204044798, 1.0, 0.9875119392763799, 0.9905928977329481, 1.0));
	sim.setValue("Q", c(0.989764175645807, 0.8455227005580892, 0.845912666837198, 0.984582239344855, 0.83996821301016, 0.9850731684596701, 0.9876542334839329, 0.9982494440502371, 0.838795459862678, 0.990724346396856, 0.9861716142299009, 0.983627843750688, 0.987800062990828, 0.997108268040869, 0.845282766744677, 0.9873076241250319, 0.9959240552622859, 0.992827995264473, 0.9976901003836891, 0.9952845501191229, 0.993563024693889, 1.00080519994233, 0.9962450970964621, 0.993470521282298, 0.9979620272144499, 0.9940218822024129, 0.9980747827167641, 1.0032483977936, 0.9898748634276929, 0.9968030544326479, 0.996114253051009, 0.99675040919206, 0.999999299579611, 1.0, 0.8413799578480491, 0.997187696701764, 0.843257307857995, 0.987306532734188, 0.9844675446944879, 0.9953953012832859, 1.0007731314191, 0.9990830718633861, 0.9997543706330649, 0.9988784467124789, 0.997690965897743, 0.986981837894563, 0.991433358312757, 0.991747279993514, 0.9990828442441401, 1.0016343300650201, 1.0));
	sim.setValue("R", c(0.984243507120495, 0.848866479269875, 0.849567104389234, 0.9790615745441461, 0.8484475087402791, 0.9760697279824481, 0.9821334922905129, 1.0, 0.841766851271317, 0.9762014329259939, 0.844470103982147, 0.9746236640157591, 0.9822794141272231, 0.9895500604693208, 0.8479147174616569, 0.9817869598957328, 0.990403383355878, 0.9852697702445279, 0.9956525510384608, 0.989763876225612, 0.9854754907467049, 0.996730184591941, 0.9866494659629541, 0.9824285987420741, 0.98818356279715, 0.9842434440532671, 0.991432728551462, 0.9999990388934878, 0.9843542185731329, 0.9892448259584259, 0.9936395066232729, 0.990751141066888, 0.9950705093972769, 0.990649241887217, 0.844261224953876, 0.9867382248694399, 0.844117196385583, 0.981785843741768, 0.978946906317092, 0.993759982951675, 0.995252467191443, 0.9889579593798481, 0.9931123412839241, 0.9933577872277671, 0.9929449186781679, 0.981461216915952, 0.9824296621915249, 0.986226619034182, 0.992440809011929, 0.9955217700840391, 1.0));
	sim.setValue("S", c(0.986810509820359, 0.845612255451891, 0.846429844969062, 0.996153212156946, 0.8472828509445139, 0.985073142161747, 1.0, 0.987800002669879, 0.9881838182886641, 0.9817206605284069, 0.9806517116522409, 0.982711217954905, 0.980241911652498, 0.9903246636934179, 0.8443907284201031, 0.988753441321933, 0.9963263384782609, 0.9887529879355199, 0.9964272909819609, 1.0, 0.9880423876332991, 0.989763864560073, 0.9852038349837341, 0.9914328494161071, 0.990750544028029, 0.9885012124490491, 0.984466087247711, 0.9914324413689929, 0.992920624188253, 0.9968031036377198, 0.9905935530011079, 0.988184018020553, 0.996918375390651, 0.9889584462038359, 0.9901701026503791, 0.983255125088616, 0.9767589242382351, 0.9965827420477, 0.9844670712831619, 0.986391521437962, 0.996515373597881, 1.0, 0.993112351957239, 0.9849458277736509, 0.988687086491948, 0.9814612149024129, 0.9918355469348101, 0.993595125804458, 0.996515909339703, 0.9940761194291892, 1.0));
	sim.setValue("T", c(0.980760749050907, 0.9776161680109151, 0.983892134191413, 0.9908777177338091, 0.8488825656090391, 0.981590021228652, 1.00189159014671, 0.98983744969212, 0.979771441743803, 0.9817207127707851, 0.9861727501382092, 0.9911856197803259, 0.9787963950628531, 0.989550038551105, 0.983254346680793, 0.9873076546677759, 0.998736252681479, 0.992828027518103, 0.9932907590554381, 0.9978515400967629, 0.9900799613753442, 0.9932470314525279, 0.9927619544672971, 0.9899871931532571, 0.9902211265338751, 0.987726591211203, 0.9934702867130729, 0.9955074780242389, 0.9898747733368771, 0.99884061366952, 0.9917149078511909, 0.9867384641736701, 1.0, 0.989874642707749, 0.9949160640187921, 0.9867382455429999, 0.982279516049234, 0.994865415157418, 0.9844670845278509, 0.9949580342028509, 0.9965153365872891, 0.9972907385373131, 0.993704305884178, 0.989550320821451, 0.9872416320141509, 0.9890201737558549, 0.9920252144311209, 0.9917472499478901, 1.0, 0.995197448841846, 1.0));
	sim.setValue("V", c(0.842384378225428, 0.8415234641389351, 0.8418266676904091, 0.8429632442147701, 0.98446704323412, 0.8433758065145179, 0.8415386313634929, 0.8417993956106842, 0.8391053697015859, 0.8431789381155258, 0.8405114640779909, 0.8422275557385641, 0.9843169094817621, 0.8460680951402461, 0.986738138646327, 0.839762972636279, 0.8440461229794302, 0.842323525272619, 0.844921056530783, 0.843499268231477, 0.843653617134272, 0.986280606597924, 0.843705741150207, 0.843398241829025, 0.844600062423535, 0.8436793873417829, 0.986503600062011, 0.9955074780217109, 0.9863917780167429, 0.9877988041204939, 0.843016115063255, 0.8435818173576372, 0.845131478521978, 0.8447078542107409, 0.8418710459036272, 0.842207937057222, 0.841566464957797, 0.9838231966215691, 0.992026181112262, 0.845054140672376, 0.8461711365610292, 0.844511471110303, 0.8438875148627422, 0.84404156427846, 0.8453395969970501, 0.986982562751961, 0.844254294838468, 0.842905730062045, 0.9875119716222891, 0.990592897735906, 1.0));
	sim.setValue("W", c(0.834214385065078, 1.0, 1.00591225757148, 0.9935862078311071, 0.9844663151620351, 0.8356257341447221, 0.9946205902343391, 0.991282986896102, 0.9867374170056509, 0.9852043618573679, 0.999434361919498, 1.0, 0.985762705232881, 0.989550158435563, 0.997187706236797, 0.9928283041414291, 1.00348226890424, 1.00405216742674, 0.9921690783039642, 0.9932467972343969, 0.995924919814942, 1.00021332834042, 1.0015760961818, 0.9969535148592851, 0.991666054929971, 0.9912097635960391, 1.00799480372759, 1.0050407573208, 0.99335805027576, 1.00580691774412, 0.9940767274509891, 0.9881847960976359, 0.9965160841511579, 0.9953953219510681, 1.00576814174836, 0.9902214827530749, 1.0, 0.9997942775240749, 0.99603720755427, 1.00313621072583, 0.9979608000696851, 0.99447796562639, 0.9951498761004309, 0.9939496439707309, 0.988688823412755, 1.00551987465145, 0.9879512744210841, 0.9897096009516541, 1.00492785626368, 1.0010424108623401, 1.0));
	sim.setValue("Y", c(0.837639415062509, 0.8455825818877549, 0.846162718924027, 0.838407107198923, 1.0, 0.9815904802907841, 0.8381311808266669, 0.9877998371937191, 0.8372462996525791, 0.8383576170068421, 0.986171405397238, 0.980144329149722, 1.0, 0.8427039592505521, 0.994825836961616, 0.8378129158884909, 0.9889571347635591, 0.987307006103871, 0.9886859149330871, 0.989763647785266, 0.990996155684484, 0.9897636893821808, 0.985204515290432, 0.841567533664653, 0.8417484673683199, 0.8410597273826129, 0.9899867494558651, 1.00551970318554, 1.0, 0.9912819530064381, 0.840972315189742, 0.991667199720491, 0.843017645747065, 0.986392217989858, 0.8432383892998441, 0.8405127388809829, 0.978797802536047, 0.990790094065286, 1.0, 0.986391884201654, 0.994477673853195, 0.842488591993129, 0.842077893500604, 0.984946120265653, 0.842324370290644, 0.997432183640851, 0.841061689598291, 0.839902279741386, 0.999999087920858, 0.9986806032621128, 1.0));
	sim.setValue("X", c(0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 0.830820541978248, 1.0));

	sim.setValue("fitness_profiles0",c(50, 16, 29, 24, 0, 39, 44, 26, 10, 32, 2, 6, 13, 7, 44, 39, 38, 1, 4, 43, 7, 19, 2, 30, 45, 24, 43, 36, 34, 45, 25, 38, 39, 4, 35, 43, 29, 0, 23, 22, 12, 18, 40, 41, 19, 6, 7, 35, 8, 1, 28, 40, 37, 36, 10, 27, 31, 36, 48, 35, 43, 2, 25, 48, 17, 16, 13, 7, 25, 36, 8, 42, 24, 35, 12, 12, 26, 3, 37, 1, 15, 23, 2, 14, 20, 21, 13, 20, 11, 34, 16, 23, 32, 20, 49, 17, 20, 37, 12, 15, 3, 23, 47, 27, 13, 37, 12, 19, 37, 7, 16, 38, 9, 9, 23, 33, 43, 7, 45, 24, 27, 6, 27, 28, 4, 40, 1, 37, 30, 48, 4, 42, 29, 26, 4, 12, 14, 1, 26, 5, 48, 4, 14, 3, 27, 22, 15, 34, 10, 36, 22, 14, 33, 48, 35, 2, 45, 39, 21, 26, 12, 1, 26, 27, 23, 19, 7, 8, 14, 26, 27, 21, 35, 25, 0, 35, 1, 37, 35, 23, 48, 30, 41, 23, 47, 49, 19, 13, 20, 20, 37, 15, 22, 46, 38, 19, 9, 13, 34, 5, 40, 26, 4, 1, 25, 12, 44, 40, 22, 33, 25, 27, 33, 27, 18, 5, 37, 15, 39, 2, 32, 1, 18, 34, 15, 37, 9, 18, 42, 3, 32, 3, 15, 17, 28, 37, 39, 19, 23, 29, 9, 7, 39, 23, 23, 28, 6, 15, 27, 18, 13, 5, 45, 35, 41, 5, 8, 24, 37, 10, 38, 44, 5, 17, 26, 14, 31, 18, 33, 29, 11, 46, 2, 44, 47, 18, 30, 0, 9, 24, 34, 32, 8, 7, 16, 24, 13, 6, 49, 21, 0, 26, 6, 24, 33, 22, 14, 9, 22, 16));
	defineConstant("start_stop_codon_positions",matrix(c(0, 897), ncol = 2, byrow = T));

	defineConstant("seq_length", 300);
	get_fitness();

	sim.setValue("fixations_p1", sim.chromosome.ancestralNucleotides(format = "integer"));
	sim.setValue("fixations_counted_p1", 0);
}


function (void) get_fitness (void){
	poses = start_stop_codon_positions;

	for (row_num in (0:(nrow(start_stop_codon_positions)-1))){
		fitnesses = c();
		aas = codonsToAminoAcids(sim.chromosome.ancestralNucleotides(drop(poses[row_num,0]), drop(poses[row_num, 1])+2, "codon"), paste = F);

		sim.setValue("ancestral_aa_seq" + asString(row_num),aas); 

		count = 0;
		for (aa in aas){
			fitnesses = c(fitnesses, sim.getValue(aa)[sim.getValue("fitness_profiles" + row_num)[count]]);
			count = count + 1; 
		}

		sim.setValue("ancestral_fitnesses" + asString(row_num), fitnesses);
		sim.setValue("ancestral_fitness_value" + asString(row_num), product(fitnesses));
		sim.setValue("ancestral_aas" + asString(row_num), aas);

	}
}


function (float) get_genome_fitness (object nucs){
	fitness_value = 1.0;
	for (row_num in (0:(nrow(start_stop_codon_positions) -1))){
		starting_pos = drop(start_stop_codon_positions[row_num,0]);
		ending_pos = drop(start_stop_codon_positions[row_num,1])+2;
		aa_stop_pos = (ending_pos - starting_pos)/3;
		aa_seq = codonsToAminoAcids(nucs.nucleotides(start = starting_pos, end = ending_pos, format = "codon"), paste = F);
		poses = (aa_seq != sim.getValue("ancestral_aas" + row_num));

		if(sum(poses) == 0){
			fitness_value = fitness_value * sim.getValue("ancestral_fitness_value" + asString(row_num));
			 next;
		}

		fitnesses = sim.getValue("ancestral_fitnesses"+row_num);
		fitnesses[poses] = sapply(which(poses), "sim.getValue(aa_seq[applyValue]);")[sim.getValue("fitness_profiles" + row_num)[poses]];

		if(any(poses[0] | poses[aa_stop_pos])){
			fitness_value = fitness_value * product(0.830820541978248/fitnesses);
			next;
		}

		if(any(aa_seq[poses] == "X")){
			pos_stop = match("X", aa_seq[0:(length(aa_seq)-1)]);
			if(pos_stop == 0){fitnesses = 0.830820541978248/fitnesses;}
			else if (pos_stop + 1 < aa_stop_pos) {fitnesses[(pos_stop+1):aa_stop_pos] = 0.830820541978248/fitnesses[(pos_stop+1):aa_stop_pos];}
		}

		fitness_value = fitness_value * product(fitnesses);
	}

	return fitness_value;
}


fitness(NULL) {return(get_genome_fitness(genome1)*get_genome_fitness(genome2));//If error says total fitness < 0.0, mutation rate is lethal
}


1:1000late () {
	if(length(sim.mutations)!= 0){
		ancestral_genome = sim.getValue("fixations_p1");
		row_num = p1.individualCount* 2;
		muts_mat = integer(row_num*1500);
		muts_mat = p1.genomes.nucleotides(NULL, NULL, "integer");
		muts_mat = matrix(muts_mat, nrow = row_num, byrow = T);
		compare_seq = c(muts_mat[0,]);

		fixed_nucs = c(matrixMult(matrix(rep(1, row_num), ncol = row_num), muts_mat)% row_num == 0);

		different_muts = (ancestral_genome != compare_seq);
		new_fixations = different_muts & fixed_nucs;
		sim.setValue("fixations_counted_p1", sim.getValue("fixations_counted_p1") + sum(new_fixations));

		ancestral_genome[new_fixations] = compare_seq[new_fixations];
		sim.setValue("fixations_p1", ancestral_genome);
	};

	if (sim.generation%100 == 0) {
		catn(sim.generation);
	};

	if (sim.generation%100 == 0) {
		writeFile("/home/erin.brintnell/Summer_2021/SLiMTreeWork/slim-tree/Examples/Ex_10_SLiM-Tree-HPC_Default_Sim/Output/backupFiles/p1.fasta",(">parent_ancestral_to_load\n" + sim.chromosome.ancestralNucleotides()));
		sim.outputFull("/home/erin.brintnell/Summer_2021/SLiMTreeWork/slim-tree/Examples/Ex_10_SLiM-Tree-HPC_Default_Sim/Output/backupFiles/p1.txt");
	};
}


1 late() {
	setup_fitness();
	writeFile("/home/erin.brintnell/Summer_2021/SLiMTreeWork/slim-tree/Examples/Ex_10_SLiM-Tree-HPC_Default_Sim/Output/_aa.fasta", "", append = F);
	writeFile("/home/erin.brintnell/Summer_2021/SLiMTreeWork/slim-tree/Examples/Ex_10_SLiM-Tree-HPC_Default_Sim/Output/_nuc.fasta", "", append = F);
	sim.addSubpop("p1", 100);
	sim.setValue("fixations", strsplit(sim.chromosome.ancestralNucleotides(),sep = ""));
	sim.setValue("fixations_counted", 0);
}


1001 late() {
	sim.outputFull("p1.txt");
	writeFile("p1.fasta", (">parent_ancestral_to_load\n" + sim.chromosome.ancestralNucleotides()));
	writeFile("p1_fixed_mutation_counts.txt",asString(sim.getValue("fixations_counted_p1")));
	writeFile("p1_fixed_mutations.txt",
	paste(sim.getValue("fixations_p1"), sep = ""));
	sim.outputFixedMutations();
	pop_seq = sample(p1.individuals.genomes, 1).nucleotides();
	pop_seq = strsplit(codonsToAminoAcids(nucleotidesToCodons(pop_seq)), sep = "");
	polymorph_str = c();
	fixed_str=c();
	for (a in 0:(length(pop_seq)-1)) {
		diffs = c();
		for (g in p1.individuals.genomes.nucleotides()){
			aa_seq = strsplit(codonsToAminoAcids(nucleotidesToCodons(g)), sep = "");
			diffs = c(diffs, aa_seq[a]);
		}
		unique_diffs = unique(diffs);
		if (length(unique_diffs) > 1) {
			polymorph_str = c(polymorph_str, a, ": ");
			for (p in unique_diffs) {
				polymorph_str = c(polymorph_str, p, ": ", length(which(diffs == p)) / length(diffs), " ");
			}
		polymorph_str = c(polymorph_str, "\n");
		} else if (length(unique_diffs) == 1) {
			fixed_str = c(fixed_str, a, ": ", unique_diffs, "\n");
		}
	}
	writeFile("/home/erin.brintnell/Summer_2021/SLiMTreeWork/slim-tree/Examples/Ex_10_SLiM-Tree-HPC_Default_Sim/Output/p1_polymorphisms.txt", paste(polymorph_str, sep = ""));
	writeFile("/home/erin.brintnell/Summer_2021/SLiMTreeWork/slim-tree/Examples/Ex_10_SLiM-Tree-HPC_Default_Sim/Output/p1_fixed_sites.txt", paste(fixed_str, sep = ""));
	system("sbatch \"/home/erin.brintnell/Summer_2021/SLiMTreeWork/slim-tree/Examples/Ex_10_SLiM-Tree-HPC_Default_Sim/Output/slimScripts/_p2.sh\"");
	system("sbatch \"/home/erin.brintnell/Summer_2021/SLiMTreeWork/slim-tree/Examples/Ex_10_SLiM-Tree-HPC_Default_Sim/Output/slimScripts/_p9.sh\"");
}