initialize() {
	setSeed(792271475);
	initializeSLiMOptions(nucleotideBased=T);
	initializeAncestralNucleotides("p6.fasta");
	mm = mmJukesCantor(0.0005);
	initializeMutationTypeNuc("m1", 0.5, "f", 0.0);
	m1.convertToSubstitution = F;
	initializeGenomicElementType("g1", m1, 1.0, mm);
	initializeGenomicElementType("g2", m1, 1.0, mm);
	initializeRecombinationRate(2.5e-08);
	initializeGenomicElement(g1, 0, 9998);
}


function (void) setup_fitness(void){
	sim.setValue("A", c(0.987726697002914, 0.977616164629395, 0.983891067973007, 1.0, 0.848840724395207, 0.981590114607551, 0.994620519264738, 0.989837424593256, 0.996333912234816, 0.987241371126429, 0.986172654070067, 0.985665079135574, 0.982279476762475, 0.991587658140999, 0.98325449956009, 0.994578643814903, 1.0, 0.995395051245473, 1.0, 0.996059150741212, 0.990080183425421, 0.994368373911212, 0.993291247716665, 0.999262691094511, 0.994478767723347, 0.995814223821733, 0.993470497044105, 0.996953008270665, 0.994479124476237, 1.00173205553549, 0.995676943765652, 0.988184156070028, 0.995845153844838, 0.994957888151684, 1.0, 0.990221216149782, 0.988921498847054, 1.0, 0.989070952813028, 0.990995767195916, 0.997290546358646, 1.00174951051439, 1.0, 0.991241206794316, 0.992761953834574, 0.990465930810146, 0.991433407004881, 0.994793267557565, 0.996515858662707, 1.0, 1.0));
	sim.setValue("C", c(0.837653020600952, 0.839442229698759, 0.841686849904925, 0.988065565174946, 0.980983048769501, 0.837903111762214, 0.987654177126328, 0.987799696279983, 0.983254774166479, 0.83812365637649, 0.986171045660813, 0.980144828799828, 0.98227974522404, 0.842315704516753, 0.986738160057529, 0.836505934824318, 0.988957203124369, 0.987307151270026, 0.988686163412148, 0.989763560118909, 0.985476796199298, 0.989763699846518, 0.839322333149262, 0.840591242220769, 0.840916737630465, 0.840182303259914, 0.989987255563771, 0.9934697111674, 0.98639201477289, 0.994765686828847, 0.839775497603613, 0.984701654520724, 0.841973404185175, 0.840773690887687, 0.992878612969347, 0.839629329108983, 0.984317030986915, 1.00236120823881, 0.987950306377039, 0.986391468086968, 0.990995107074489, 0.841372874288417, 0.840911797341074, 0.840068146394994, 0.841394452255712, 0.986982051681398, 0.840579388281627, 0.838914774106506, 0.994478277224315, 0.990593127028041, 1.0));
	sim.setValue("D", c(0.996293296524039, 0.845582581473911, 0.846283206722939, 0.984582016646474, 0.838717957990266, 1.0, 0.991137421598479, 0.987799696478328, 0.983254709588241, 0.998812097381644, 0.841648158558239, 0.98014482134889, 0.982280186273354, 1.0, 0.840167243073804, 0.983824144594874, 0.994478402455583, 0.99079052775561, 0.992169504799753, 1.00080519634331, 1.0, 0.989763701894664, 0.994982065075481, 0.999999425721922, 1.00067052267193, 0.997505040035359, 0.98998724178136, 0.993469711173895, 0.995395432689491, 0.991282249298362, 0.992631074044952, 0.99166732181194, 0.996516159299997, 0.993357582762729, 0.839475661331308, 0.994825850289364, 0.841169080300452, 0.838947864161109, 0.984467632725005, 0.986391459846148, 0.997961563804286, 1.00203672841058, 0.996271166721391, 0.988429303087304, 0.994982180626475, 0.84228441293331, 1.0, 0.996676141371304, 0.990994974904006, 0.999597011014126, 1.0));
	sim.setValue("E", c(0.992331154633371, 0.845582581665932, 0.84628320675557, 0.984582213227996, 0.845326737198726, 0.992039798056886, 0.987654174067487, 0.991283016070659, 0.983254779141552, 1.0, 0.841672025020207, 0.983627681812021, 0.982280186295118, 0.999999547891696, 0.84232024849323, 0.987307658987406, 0.997961609625962, 0.992828169090178, 0.995652712833033, 0.995284496751855, 0.999408223163429, 0.995284543957918, 1.0, 1.00274584290412, 1.00323750206539, 1.0, 0.996953641134559, 1.00043616637867, 0.991912234534756, 0.991282291147458, 0.996114207379953, 0.991667321879244, 1.00059121638614, 0.999280482954135, 0.985911209338665, 1.0, 0.843184135896933, 0.841091926516696, 0.984467658378225, 0.993357608748554, 0.996515895044842, 1.00203672846488, 1.00211618076141, 0.996995607248283, 0.997690619665551, 0.843912913643915, 0.998991573720531, 0.996005141742695, 0.994478268764448, 1.0026428699301, 1.0));
	sim.setValue("F", c(0.845094282377583, 0.977617444986156, 0.992895676299858, 0.841822081245653, 0.999644914471694, 0.84238604007103, 0.837681049779115, 0.837420398697593, 0.836244291209474, 0.846080209015277, 0.993139097498765, 0.980144827608031, 0.995168638570322, 0.843450021177818, 1.00382939140376, 0.836691141191649, 0.988957206080706, 0.987307154924317, 0.840832041134712, 0.839829422323288, 0.988959015138284, 0.993246997062128, 0.985204083554661, 0.84055989416506, 0.842393345273414, 0.841644243075572, 0.993470463185301, 1.00391936336639, 0.998878467089254, 0.996803239010138, 0.840770267388325, 0.984701654541771, 0.842132147669152, 0.986391707156128, 0.838307587072434, 0.839927036071516, 0.982279650239089, 0.990790243969415, 0.999999764641191, 0.986391468148743, 0.994478392328671, 0.842228615562505, 0.841535751197143, 0.840364529452391, 0.842541518076077, 1.00059105266744, 0.841954103512172, 0.840726549023409, 0.999082805648916, 0.996113829610812, 1.0));
	sim.setValue("G", c(1.0, 0.848050252137524, 0.84890825798094, 0.99154868261552, 0.846532547479878, 0.98711065719112, 0.98969183293181, 0.987799878757258, 1.0, 0.983758208705436, 0.845404336180098, 0.976661672571855, 0.978796588022772, 0.98955016424173, 0.844280139398344, 0.985862011217136, 0.990995249088381, 0.983824005130546, 0.998092526856063, 0.99673016736537, 0.985475867872866, 0.986280482688223, 0.981720914902265, 0.987949493041747, 0.990221043740694, 0.988847883984809, 0.843295242238123, 0.989986557404871, 0.992686777903691, 0.996803255874952, 0.9871103644826, 0.986738576624995, 0.989549809348028, 0.988428810689424, 0.987949804586102, 0.983255204088304, 0.975314113586203, 0.991911684804222, 0.980984603140802, 0.98290852508832, 0.99447838640798, 1.00144486236101, 0.990221088860212, 0.981463383536289, 0.989808249299367, 0.844908055613148, 0.989071605338457, 0.990831154444221, 0.987511858166105, 0.994076337693946, 1.0));
	sim.setValue("H", c(0.98772640807616, 0.845552730690297, 0.845944615827018, 0.83663814172019, 0.984466817689194, 0.987110698984672, 0.987654173078543, 0.993320595100728, 0.837354088300993, 0.981723099833921, 0.83778420238742, 0.980144830021255, 0.998454726685666, 0.991587654819436, 0.841836600315122, 0.98382414633333, 0.992440822604721, 0.987307154939569, 0.992169522421848, 0.996730154726811, 0.992441992399849, 0.993246991721092, 0.988686860040271, 0.98794885594493, 0.988183222857494, 0.984243531936603, 0.993470462188656, 1.00504068517038, 0.996840950890445, 0.99128224981789, 0.990593505470493, 1.0, 0.995070524645169, 0.991911939635446, 0.843377539076098, 0.986738355389596, 0.841242074284459, 0.987306823903119, 0.991433510016919, 0.989874658920693, 0.997961563784716, 0.990994578819437, 0.988183344175052, 0.99046663675064, 0.990724508997474, 0.986982055668959, 0.984468512362885, 0.986226792028359, 1.0007736345586, 1.00104265360006, 1.0));
	sim.setValue("I", c(0.84154191064605, 0.994239862420645, 1.00275336274913, 0.842740062521412, 0.9789448324177, 0.842137422884164, 0.98561663528636, 0.98576219190092, 0.839877315441719, 0.842699118424453, 0.997396776195424, 0.992903095215317, 0.980242238312109, 0.844900792491479, 0.99447927055522, 0.981786728088376, 0.993886556755598, 0.996311216211822, 0.842927860899157, 0.987726046388244, 0.988958889031598, 0.995814018765701, 0.992944584887658, 0.985911276580046, 0.843684047232088, 0.843100228151295, 1.00274601843336, 0.998398652630265, 0.984354501147284, 0.99824889469883, 0.985072452703885, 0.982664093250325, 0.987512153132955, 0.987836992874976, 0.992878625280355, 0.981217997569579, 0.991555071461284, 0.985268502774712, 0.989395888968677, 0.995924568622352, 0.992440855348497, 0.988957065655649, 0.986145837917024, 0.986391680613862, 0.844124687557438, 1.0, 0.843341169431094, 0.841757857841535, 0.997961494480437, 0.988555612447242, 1.0));
	sim.setValue("K", c(0.992331152611605, 0.841797326574068, 0.84249795176628, 0.836565676680632, 0.84535694874753, 0.985073234967691, 0.987654177907709, 1.00521571786091, 0.837330335290555, 0.98724136163885, 0.83899740913034, 0.980144826451051, 0.982279732237043, 0.998553912461047, 0.842090461957405, 0.987307659036691, 0.997045418460099, 0.990790513976895, 1.00025713148886, 0.996730157676779, 0.992441992399318, 1.00181361317973, 0.994982069476483, 0.993470061267573, 1.00023329188302, 0.991209712428577, 0.996953647096928, 1.00391936336662, 0.98987477572117, 0.991282278031113, 0.999999617979616, 0.994479395876541, 1.00243908418846, 0.995395172382458, 0.841124427763233, 0.995742033092825, 0.843084877051065, 0.839178674371929, 0.984468049458387, 1.0, 1.00203658606215, 0.996515998721553, 1.00107276139927, 1.0, 1.0, 0.842234161254011, 0.989987849280571, 0.994314326980431, 0.996515803400253, 0.997559489177123, 1.0));
	sim.setValue("L", c(0.847760038535698, 0.982544915722591, 1.0, 0.847800961434632, 0.980983555429373, 0.848585476341541, 0.982133459962738, 0.985762363900651, 0.977734118883592, 0.847895796833912, 1.0, 0.985073183029771, 0.982279460117007, 0.980546566716977, 1.0, 0.98178697098329, 0.990403412526316, 0.993836448218452, 0.986648830878433, 0.984242896138715, 0.988042595655987, 1.0, 0.987770536751416, 0.985912005053898, 0.98266255907696, 0.978722866267932, 1.0, 1.0, 0.986391573682953, 1.0, 0.987110412373799, 0.982663683102453, 0.984029002873067, 0.99335762185177, 0.985912291145693, 0.981217691066976, 0.986884071399537, 0.987307164400205, 0.990517045361822, 0.990649053130023, 0.99525303492013, 0.985473913994255, 0.9861460006303, 0.986391591508588, 0.979684312051505, 0.996258455281716, 0.978947853323562, 0.980705997205828, 0.997045312440133, 0.993160147808111, 1.0));
	sim.setValue("M", c(0.836214610239881, 0.984582513391269, 0.997824656917514, 0.838629366014872, 0.984465683850682, 0.837129817065858, 0.991137362051573, 0.991282818708411, 0.835338597084704, 0.837206056988676, 1.00445268587788, 0.99059388286425, 0.985762893122202, 0.838692226830708, 0.999999719753476, 0.830820541977203, 0.995923974768928, 0.994273661862403, 0.992169356639645, 0.993246712680092, 0.992442168027656, 1.00481781728824, 0.988687238608151, 0.834874501314598, 0.837295225884332, 0.836871378482087, 1.00043675674522, 1.00247366146301, 0.989875176977912, 1.00633658599571, 0.833671064971029, 0.988184765949047, 0.993032818349968, 0.99796199373038, 0.992878526778094, 0.986739876318469, 0.987800166377569, 0.994273391168174, 0.993470987675309, 0.993357642942404, 1.00144468690695, 0.835929564494643, 0.834881373656676, 0.988429653668628, 0.837570256716978, 0.997432233880715, 0.837269428217986, 0.835574044714891, 1.00144458886523, 0.994076296410252, 1.0));
	sim.setValue("N", c(0.997132772870043, 0.841496582371809, 0.842343300261516, 0.984582016629495, 0.838763207164275, 0.997962343626178, 0.996658134003531, 0.993320595729856, 0.983254700631561, 0.98868697739693, 0.837987275999512, 0.983627641645773, 0.989245844294975, 0.999328530836302, 0.840075497346699, 0.983824147671501, 0.995924068753614, 0.987307155679571, 0.995652713334217, 1.00506299045514, 0.996516982424061, 0.993246992226929, 0.98868687745602, 0.991432592989399, 0.993704151072183, 0.989764077637973, 0.989987244840558, 0.9969529878742, 0.996840950865113, 0.994765685860919, 0.99059350547772, 0.998633541425628, 0.999328305758416, 0.991911940031019, 0.841086833612002, 0.990221449377584, 0.839556088607296, 0.990790243087002, 0.984468049449869, 0.989874659002179, 1.00203658344472, 0.999999163800578, 0.993704176042824, 0.988429303089392, 0.99498219929371, 0.840846002568504, 0.994916557675949, 0.994314326982537, 0.999998989100667, 0.996113829611234, 1.0));
	sim.setValue("P", c(0.980760428085864, 0.843555256053692, 0.843980582343544, 0.984582363709273, 0.847444155260637, 0.978107505708518, 0.987654265522504, 0.98431652537426, 0.979771640459152, 0.978237605288416, 0.840731763846579, 0.976661676063384, 0.840954574581512, 0.98258406615187, 0.843409893659597, 1.0, 0.990995250447063, 1.0, 0.985203013062735, 0.986280409294205, 0.981993571727707, 0.986280553740861, 0.981720912862455, 1.0, 1.0, 0.980760378335402, 0.986504099207682, 0.989986557405181, 0.988429078684956, 0.987799168024024, 1.0, 0.981218467641851, 0.9860665150042, 0.982908516632281, 0.982427292890347, 0.841925376019369, 0.975314113582633, 0.983823390769856, 0.980984603294354, 0.982908526439435, 1.0, 0.994478575061354, 0.988183516797051, 0.981463385651925, 0.98172164960273, 0.843747761001827, 0.987950300514394, 1.0, 0.987511822331316, 0.99059316900246, 1.0));
	sim.setValue("Q", c(0.989764155135028, 0.845522700526558, 0.845912666823217, 0.984582215282263, 0.839977054738345, 0.985073236458883, 0.987654176887968, 0.998249383547795, 0.838804332989445, 0.990724414887538, 0.986171263035404, 0.983627681812507, 0.987800159533997, 0.997108258949543, 0.845282766723393, 0.987307636977353, 0.995924069001646, 0.992828169088742, 0.997690188230429, 0.995284496750383, 0.993563244430242, 1.0008052043758, 0.996244948612216, 0.993470389585949, 0.997961974396546, 0.994021845212337, 0.998074931485447, 1.00324835839037, 0.989874774327011, 0.996803240819834, 0.996114203187414, 0.996750663101973, 0.999999338128752, 1.0, 0.841379957831583, 0.997187672162465, 0.843257307922888, 0.987306832064514, 0.984467694070282, 0.995395121890788, 1.00077369552511, 0.999082986124396, 0.999754356192179, 0.998878522282196, 0.997690619668315, 0.986982036579939, 0.991433452155196, 0.99174733176923, 0.999082799083674, 1.0016345350121, 1.0));
	sim.setValue("R", c(0.984243490362112, 0.848866479131047, 0.849567104416049, 0.97906135907287, 0.848444260928449, 0.976070107160806, 0.982133459942866, 1.0, 0.841766851261959, 0.976201794334158, 0.844470103962997, 0.974624161563189, 0.982279457027136, 0.989550005327598, 0.847918576950832, 0.981786970921265, 0.990403384347661, 0.985269844264963, 0.995652634999504, 0.989763834993898, 0.985475739317853, 0.996730191188972, 0.986649264410508, 0.982428159039549, 0.988183478430456, 0.984243411590183, 0.991432940806231, 0.999998964754043, 0.984354114179914, 0.989245021771976, 0.993639448899282, 0.990751060151754, 0.995070551827149, 0.990649065535129, 0.844271214965427, 0.986738382678519, 0.844132463552359, 0.981785930512164, 0.978947047650039, 0.993759824910375, 0.995253031920902, 0.988957854431117, 0.993112345157933, 0.993357853498357, 0.992944763471388, 0.98146148473759, 0.982429788558728, 0.986226668700925, 0.992440755945752, 0.995521988829075, 1.0));
	sim.setValue("S", c(0.986810488405089, 0.84561816897303, 0.846424061043337, 0.996153207111767, 0.847286947635206, 0.985073124375579, 1.0, 0.987799970121528, 0.988183847545043, 0.98172069612575, 0.980650786239959, 0.982711376312124, 0.980241988361372, 0.990324709000574, 0.844382909886578, 0.98875336570365, 0.996326347186327, 0.988753038524714, 0.996427391473655, 1.0, 0.988042607354088, 0.989763878310041, 0.985203654332084, 0.991432730031042, 0.990750488302999, 0.988501175507904, 0.98446658673407, 0.991432323074409, 0.99292055092483, 0.996803315506685, 0.990593506255421, 0.988184116678657, 0.996918404572068, 0.988958294006547, 0.99017010283357, 0.983255153071621, 0.976758975696565, 0.996582776206644, 0.984467140990008, 0.986391315394264, 0.996515926574736, 1.0, 0.993112355815165, 0.984945975811573, 0.988686919149721, 0.981461481725266, 0.991835620064089, 0.993595208282047, 0.996515859241443, 0.994076347939123, 1.0));
	sim.setValue("T", c(0.980760428072145, 0.977616197462542, 0.983891067698422, 0.99087768749551, 0.848882565614274, 0.981590089732205, 1.001891653349, 0.9898374245682, 0.979771638473771, 0.981720760341432, 0.986172653282351, 0.991185739202874, 0.978796592269614, 0.989550164583297, 0.983254477412748, 0.987307654259919, 0.998736266178362, 0.992828059235412, 0.993290830832506, 0.997851479851318, 0.990080181083656, 0.993247041782566, 0.992761805812978, 0.989987061570534, 0.990221043742588, 0.987726560931941, 0.9934704990418, 0.995507366212736, 0.989874610035954, 0.99884082848417, 0.991714809488766, 0.986738577316803, 1.0, 0.989874439883087, 0.994916061133135, 0.986738289125832, 0.982279483834126, 0.994865449394766, 0.984467175205612, 0.994957875696811, 0.996515915905445, 0.997290653616657, 0.993704205344319, 0.989550417122238, 0.987241351399778, 0.989020254187852, 0.992025279099291, 0.991747345997068, 1.0, 0.995197658067104, 1.0));
	sim.setValue("V", c(0.842384378427678, 0.841536851148373, 0.841819405562859, 0.842958165629885, 0.984467147795084, 0.843375806581129, 0.841530248784963, 0.841791124227616, 0.83911371000591, 0.843189819764259, 0.840526456411437, 0.842217722898904, 0.98431699183433, 0.846082736364034, 0.986738181593882, 0.839779339332007, 0.844055975136899, 0.842313692439437, 0.844913440457747, 0.84350795629774, 0.843653617130814, 0.986280636989756, 0.843715831942116, 0.843389321159068, 0.844592714708563, 0.843679387236877, 0.986504099196833, 0.995507366217762, 0.986391627421766, 0.987799167927008, 0.843016115096843, 0.84359108516855, 0.84514004761032, 0.84470785418946, 0.841871045962236, 0.842226218622356, 0.841557968787396, 0.983823390773521, 0.992026263373972, 0.845073261174617, 0.846161456066393, 0.844529233169539, 0.843878781240662, 0.844041564407653, 0.845339597027985, 0.986982659093, 0.844261876388914, 0.842919954810567, 0.987511854188552, 0.990593168995056, 1.0));
	sim.setValue("W", c(0.834214385035553, 1.0, 1.00591218570444, 0.993586206171342, 0.984465683850228, 0.835625734115416, 0.994620578781022, 0.991282818533625, 0.986737929430977, 0.985204472056791, 0.999434371806485, 1.0, 0.985762896105132, 0.98955035032502, 0.997187759348963, 0.992828315249167, 1.00348228493503, 1.00405221126661, 0.992169356642916, 0.993246712202753, 0.995925149666022, 1.00021333889496, 1.00157597423089, 0.996953382912049, 0.991666362218472, 0.991209724959341, 1.00799499061824, 1.00504064785462, 0.993357930986308, 1.00580713205323, 0.994076666369983, 0.988184766105403, 0.996516116112865, 0.995395110222785, 1.00576814063728, 0.990221507245251, 1.0, 0.999794180444121, 0.99603728197872, 1.00313605723297, 0.997961519099807, 0.994477729847717, 0.995149814797897, 0.993949791904291, 0.98868806212732, 1.0055199979341, 0.987951608488982, 0.989710537991394, 1.00492780135377, 1.00104264096065, 1.0));
	sim.setValue("X", c(0.834214385035553, 0.839442229698759, 0.841686849904925, 0.836565676680632, 0.838717957990266, 0.835625734115416, 0.837681049779115, 0.837420398697593, 0.835338597084704, 0.837206056988676, 0.83778420238742, 0.842217722898904, 0.840954574581512, 0.838692226830708, 0.840075497346699, 0.830820541977203, 0.844055975136899, 0.842313692439437, 0.840832041134712, 0.839829422323288, 0.843653617130814, 0.986280482688223, 0.839322333149262, 0.834874501314598, 0.837295225884332, 0.836871378482087, 0.843295242238123, 0.989986557404871, 0.984354114179914, 0.987799167927008, 0.833671064971029, 0.84359108516855, 0.841973404185175, 0.840773690887687, 0.838307587072434, 0.839629329108983, 0.839556088607296, 0.838947864161109, 0.978947047650039, 0.845073261174617, 0.846161456066393, 0.835929564494643, 0.834881373656676, 0.840068146394994, 0.837570256716978, 0.840846002568504, 0.837269428217986, 0.835574044714891, 0.987511822331316, 0.988555612447242, 1.0));
	sim.setValue("Y", c(0.83765302059917, 0.845582581502062, 0.84616271892082, 0.838407107206407, 1.0, 0.981590853872871, 0.838131180536411, 0.987799696485703, 0.837258391599357, 0.838357617182339, 0.98617104565998, 0.980144826808078, 1.0, 0.842703959191998, 0.994825885747022, 0.837825007783673, 0.988957203010657, 0.987307160693399, 0.988686164395741, 0.989763559069637, 0.990996404087255, 0.989763708987678, 0.985204082537654, 0.841580370947407, 0.841761437553156, 0.841072902614964, 0.989987251614723, 1.00551963360958, 1.0, 0.991282320248082, 0.840972315080669, 0.991667313709026, 0.84301764573618, 0.986391707153259, 0.843244520349355, 0.840525575897183, 0.978797268810746, 0.990790243105672, 1.0, 0.986391460796337, 0.994478392719541, 0.842501907630287, 0.842090409012921, 0.98494648012728, 0.842337408112927, 0.997432248612792, 0.841061689611669, 0.839915249884285, 0.999999033043471, 0.998680812569137, 1.0));

	sim.setValue("fitness_profiles0",c(49, 0, 3, 24, 26, 21, 43, 4, 2, 43, 40, 22, 32, 6, 16, 44, 37, 1, 19, 3, 1, 34, 35, 4, 12, 45, 14, 3, 45, 2, 47, 46, 10, 37, 9, 1, 7, 0, 12, 42, 31, 30, 17, 21, 16, 23, 6, 17, 36, 30, 6, 2, 33, 6, 37, 29, 9, 28, 33, 36, 4, 14, 6, 3, 19, 32, 26, 12, 46, 36, 46, 48, 13, 37, 21, 21, 29, 9, 38, 31, 19, 18, 20, 2, 6, 8, 9, 8, 48, 31, 43, 42, 40, 4, 8, 29, 2, 34, 36, 47, 5, 9, 37, 25, 31, 12, 18, 39, 48, 11, 23, 37, 48, 30, 29, 40, 18, 38, 9, 45, 5, 43, 20, 34, 42, 9, 17, 11, 42, 22, 13, 16, 16, 39, 33, 31, 8, 22, 30, 22, 0, 19, 14, 10, 2, 26, 24, 27, 1, 29, 47, 47, 32, 17, 35, 31, 20, 30, 3, 1, 8, 38, 39, 6, 26, 10, 32, 3, 30, 43, 47, 13, 13, 16, 33, 5, 33, 7, 33, 43, 5, 17, 13, 11, 35, 32, 24, 23, 34, 11, 13, 17, 34, 44, 2, 7, 3, 30, 25, 0, 30, 21, 26, 14, 43, 18, 16, 42, 0, 25, 18, 46, 14, 25, 32, 5, 46, 28, 25, 39, 30, 9, 39, 36, 9, 32, 38, 1, 3, 18, 22, 35, 13, 21, 38, 22, 24, 21, 35, 26, 23, 21, 14, 31, 16, 28, 18, 27, 3, 20, 5, 44, 36, 30, 13, 13, 19, 46, 20, 18, 20, 35, 9, 25, 14, 28, 21, 10, 42, 40, 25, 9, 45, 44, 45, 22, 43, 9, 27, 41, 36, 13, 29, 13, 13, 21, 17, 43, 39, 42, 17, 7, 36, 35, 4, 30, 8, 6, 40, 34, 31, 42, 45, 0, 10, 27, 15, 33, 46, 18, 27, 23, 30, 15, 41, 1, 31, 21, 25, 30, 7, 13, 17, 40, 27, 41, 33, 24, 10, 38, 32, 15, 29, 18, 3, 22, 27, 3, 8, 5, 37, 10, 44, 10, 44, 25, 12, 41, 6, 27, 44, 46, 24, 40, 6, 35, 15, 20, 35, 48, 47, 4, 41, 44, 5, 31, 3, 41, 22, 31, 16, 6, 36, 30, 0, 33, 40, 43, 39, 9, 15, 46, 37, 3, 33, 1, 10, 31, 40, 26, 37, 22, 28, 32, 4, 25, 5, 40, 35, 24, 10, 13, 10, 47, 6, 44, 41, 12, 37, 4, 35, 19, 47, 39, 29, 1, 36, 40, 38, 34, 13, 38, 43, 40, 1, 46, 48, 18, 10, 34, 15, 18, 1, 47, 34, 1, 12, 38, 25, 34, 6, 37, 0, 12, 32, 10, 3, 35, 5, 19, 14, 35, 2, 36, 38, 32, 28, 25, 42, 7, 12, 15, 38, 30, 40, 17, 48, 35, 8, 18, 2, 17, 40, 14, 9, 18, 45, 8, 6, 38, 28, 28, 24, 40, 37, 40, 33, 31, 32, 1, 40, 19, 45, 15, 0, 15, 0, 24, 3, 3, 46, 9, 41, 6, 8, 16, 36, 1, 47, 14, 22, 4, 13, 40, 39, 38, 10, 15, 32, 31, 43, 30, 16, 7, 29, 18, 0, 24, 34, 24, 3, 9, 27, 40, 3, 38, 41, 26, 12, 28, 45, 20, 32, 21, 6, 28, 24, 11, 0, 43, 20, 17, 5, 7, 7, 28, 31, 21, 26, 24, 4, 20, 37, 13, 46, 31, 21, 14, 2, 23, 10, 28, 48, 1, 32, 30, 45, 2, 0, 19, 8, 15, 2, 18, 13, 48, 19, 29, 29, 34, 30, 10, 27, 17, 3, 12, 46, 37, 36, 15, 21, 34, 44, 22, 37, 48, 48, 44, 41, 48, 0, 37, 46, 23, 1, 21, 42, 25, 30, 25, 12, 30, 46, 10, 42, 31, 27, 37, 47, 30, 31, 14, 38, 7, 32, 43, 42, 19, 17, 38, 23, 2, 15, 11, 9, 43, 19, 24, 29, 39, 14, 10, 4, 9, 16, 3, 24, 19, 44, 37, 37, 42, 3, 6, 7, 48, 16, 29, 40, 27, 26, 34, 16, 16, 31, 29, 4, 15, 24, 3, 32, 40, 7, 9, 18, 28, 28, 34, 29, 27, 7, 36, 16, 44, 48, 11, 0, 42, 34, 17, 28, 44, 13, 3, 10, 31, 12, 27, 34, 42, 40, 47, 28, 1, 47, 46, 34, 31, 2, 9, 33, 20, 25, 10, 17, 31, 41, 45, 11, 39, 12, 36, 29, 20, 26, 45, 8, 7, 15, 14, 29, 25, 28, 1, 35, 25, 31, 48, 44, 24, 34, 43, 33, 42, 1, 4, 3, 35, 7, 13, 34, 39, 7, 47, 12, 48, 33, 11, 27, 41, 43, 17, 1, 12, 47, 39, 46, 41, 1, 37, 4, 8, 44, 2, 2, 31, 5, 44, 23, 14, 31, 24, 28, 42, 9, 34, 47, 22, 46, 23, 23, 32, 16, 40, 45, 4, 16, 42, 20, 9, 25, 21, 32, 41, 7, 35, 33, 44, 34, 8, 13, 26, 12, 36, 37, 3, 38, 25, 31, 19, 23, 16, 20, 0, 30, 23, 9, 25, 24, 46, 35, 17, 15, 8, 42, 6, 24, 37, 41, 41, 9, 13, 2, 23, 17, 29, 39, 3, 20, 41, 39, 29, 29, 13, 1, 47, 36, 48, 18, 17, 21, 10, 31, 20, 10, 45, 29, 10, 14, 14, 16, 1, 32, 23, 44, 47, 27, 25, 36, 8, 17, 12, 48, 28, 46, 29, 7, 43, 39, 3, 11, 36, 28, 46, 31, 35, 24, 25, 14, 31, 48, 15, 9, 35, 33, 16, 11, 13, 11, 24, 40, 19, 19, 25, 30, 7, 11, 41, 2, 48, 2, 20, 8, 37, 4, 5, 35, 40, 41, 6, 26, 41, 25, 30, 33, 12, 22, 4, 46, 2, 10, 14, 39, 7, 24, 3, 22, 4, 19, 45, 7, 40, 48, 26, 42, 45, 22, 18, 19, 18, 23, 9, 12, 43, 7, 34, 19, 17, 22, 44, 7, 2, 34, 46, 35, 46, 28, 42, 25, 7, 31, 26, 45, 19, 6, 17, 21, 29, 7, 37, 14, 28, 41, 45, 30, 6, 16, 20, 28, 32, 41, 34, 19, 32, 45, 38, 33, 6, 12, 45, 40, 15, 39, 19, 26, 40, 20, 22, 10, 7, 32, 31, 1, 47, 46, 44, 28, 29, 43, 35, 16, 36, 15, 33, 48, 41, 44, 17, 32, 45, 23, 27, 8, 39, 13, 19, 5, 0, 39, 14, 41, 16, 47, 8, 21, 47, 7, 13, 3, 32, 0, 34, 32, 48, 9, 44, 32, 10, 8, 28, 2, 20, 38, 18, 20, 17, 48, 30, 38, 7, 29, 36, 7, 30, 25, 26, 12, 46, 24, 40, 19, 13, 31, 32, 36, 9, 29, 22, 17, 47, 19, 14, 1, 36, 2, 37, 4, 16, 23, 7, 8, 18, 37, 25, 28, 46, 3, 42, 10, 25, 42, 28, 45, 2, 38, 45, 35, 28, 26, 29, 2, 32, 24, 45, 12, 3, 9, 38, 21, 28, 11, 27, 48, 45, 48, 5, 22, 42, 23, 23, 29, 34, 4, 21, 22, 35, 21, 29, 31, 5, 17, 29, 38, 10, 8, 8, 2, 43, 40, 37, 34, 3, 17, 2, 41, 27, 27, 37, 16, 28, 26, 46, 43, 46, 2, 7, 38, 17, 20, 45, 35, 40, 11, 3, 15, 0, 17, 19, 17, 26, 45, 6, 21, 31, 22, 1, 45, 6, 6, 29, 12, 40, 1, 35, 41, 45, 0, 4, 21, 39, 19, 34, 23, 22, 32, 45, 38, 17, 22, 7, 8, 25, 5, 41, 34, 22, 30, 10, 43, 4, 45, 14, 19, 47, 33, 7, 1, 0, 41, 40, 12, 45, 1, 4, 47, 6, 21, 30, 12, 10, 16, 30, 12, 30, 45, 26, 6, 23, 11, 22, 42, 13, 4, 32, 8, 19, 43, 38, 12, 42, 11, 2, 38, 43, 40, 0, 10, 32, 47, 15, 35, 8, 14, 42, 22, 47, 12, 11, 44, 17, 0, 23, 29, 31, 35, 39, 3, 12, 4, 15, 17, 33, 45, 44, 40, 13, 9, 17, 40, 43, 3, 20, 14, 0, 31, 10, 3, 46, 15, 21, 2, 18, 10, 26, 17, 26, 17, 13, 23, 23, 8, 18, 38, 29, 16, 2, 35, 43, 44, 18, 32, 19, 21, 12, 7, 12, 37, 22, 40, 17, 25, 47, 13, 5, 22, 5, 32, 17, 36, 26, 35, 45, 14, 22, 30, 41, 33, 1, 46, 36, 10, 41, 39, 18, 24, 34, 25, 33, 15, 13, 21, 9, 43, 43, 46, 42, 22, 26, 48, 21, 40, 2, 21, 28, 3, 4, 3, 5, 28, 12, 28, 42, 32, 2, 23, 6, 35, 43, 9, 44, 17, 25, 13, 26, 33, 29, 22, 43, 26, 1, 26, 20, 17, 44, 12, 9, 3, 22, 6, 17, 0, 26, 25, 21, 5, 16, 29, 19, 2, 7, 38, 29, 47, 23, 29, 13, 2, 21, 27, 11, 6, 6, 15, 7, 39, 38, 7, 30, 26, 26, 21, 17, 1, 37, 46, 28, 31, 3, 36, 9, 33, 26, 29, 31, 13, 7, 5, 41, 6, 47, 27, 38, 47, 25, 25, 34, 0, 11, 47, 15, 6, 45, 22, 2, 28, 32, 47, 33, 41, 35, 41, 29, 38, 14, 42, 32, 40, 43, 1, 44, 48, 37, 35, 29, 48, 31, 15, 16, 2, 13, 42, 20, 14, 35, 22, 18, 2, 25, 35, 44, 1, 32, 46, 12, 25, 16, 3, 31, 44, 18, 32, 6, 35, 21, 38, 4, 14, 20, 4, 41, 10, 37, 7, 37, 18, 9, 3, 11, 31, 10, 26, 3, 8, 44, 23, 40, 38, 26, 44, 19, 39, 6, 27, 24, 30, 14, 33, 2, 5, 44, 16, 2, 33, 35, 42, 30, 26, 45, 31, 39, 38, 4, 7, 42, 31, 41, 0, 23, 6, 27, 27, 12, 37, 34, 14, 20, 6, 8, 26, 21, 31, 47, 47, 33, 13, 19, 18, 47, 40, 43, 44, 6, 31, 28, 29, 31, 36, 8, 11, 37, 30, 32, 13, 15, 19, 31, 15, 42, 45, 0, 19, 26, 10, 3, 12, 45, 28, 11, 12, 46, 16, 34, 45, 30, 42, 39, 22, 4, 20, 37, 11, 24, 16, 29, 41, 22, 38, 9, 41, 43, 15, 26, 32, 21, 41, 40, 45, 4, 1, 5, 41, 27, 20, 27, 44, 44, 7, 30, 5, 11, 31, 14, 13, 10, 33, 11, 16, 33, 47, 34, 19, 9, 47, 30, 23, 6, 30, 31, 35, 31, 27, 3, 13, 29, 42, 37, 12, 15, 4, 14, 11, 34, 44, 12, 11, 1, 6, 29, 35, 5, 24, 9, 43, 12, 9, 46, 36, 46, 20, 32, 31, 21, 3, 31, 31, 27, 11, 13, 32, 15, 37, 30, 43, 47, 10, 4, 39, 1, 9, 37, 39, 12, 1, 24, 7, 30, 32, 4, 26, 10, 14, 43, 44, 41, 23, 31, 0, 9, 31, 20, 14, 0, 21, 19, 27, 42, 35, 33, 12, 6, 7, 42, 3, 22, 33, 9, 31, 5, 6, 2, 25, 7, 30, 41, 14, 35, 31, 46, 11, 6, 28, 32, 19, 36, 31, 42, 32, 13, 19, 17, 14, 36, 43, 48, 40, 37, 38, 35, 26, 39, 5, 32, 47, 15, 2, 37, 37, 29, 7, 38, 34, 42, 46, 8, 14, 15, 18, 5, 20, 38, 11, 10, 11, 10, 44, 3, 44, 29, 19, 11, 36, 2, 36, 13, 46, 41, 11, 6, 38, 30, 40, 1, 15, 35, 27, 32, 34, 43, 48, 11, 48, 45, 16, 44, 27, 25, 17, 9, 30, 35, 44, 3, 44, 42, 28, 30, 48, 37, 30, 1, 23, 6, 36, 40, 33, 40, 42, 25, 38, 31, 18, 18, 3, 8, 42, 25, 9, 29, 6, 10, 16, 5, 13, 25, 42, 1, 11, 13, 12, 8, 20, 36, 31, 23, 3, 46, 13, 37, 22, 17, 47, 27, 0, 20, 25, 31, 25, 30, 7, 42, 42, 39, 33, 29, 7, 40, 38, 33, 1, 48, 5, 34, 23, 28, 27, 41, 17, 31, 33, 12, 15, 46, 43, 34, 3, 28, 37, 37, 46, 21, 14, 21, 35, 28, 8, 46, 3, 29, 5, 17, 47, 12, 42, 28, 42, 18, 8, 0, 41, 28, 7, 13, 44, 45, 24, 45, 48, 4, 9, 34, 17, 44, 28, 33, 27, 15, 14, 32, 31, 48, 23, 9, 11, 43, 46, 9, 44, 2, 31, 34, 46, 48, 43, 14, 1, 31, 48, 15, 10, 36, 23, 34, 5, 44, 15, 48, 8, 33, 6, 5, 12, 20, 32, 30, 21, 39, 40, 4, 37, 30, 40, 26, 12, 43, 29, 4, 0, 48, 48, 5, 48, 4, 26, 43, 7, 1, 12, 29, 7, 43, 22, 22, 9, 26, 37, 29, 45, 20, 32, 2, 23, 36, 39, 31, 34, 16, 4, 20, 37, 17, 4, 37, 20, 2, 28, 24, 42, 33, 41, 8, 9, 28, 27, 32, 23, 38, 33, 3, 37, 25, 37, 7, 2, 19, 6, 0, 35, 39, 23, 7, 22, 25, 22, 46, 23, 9, 45, 4, 26, 3, 1, 22, 10, 46, 8, 38, 9, 15, 29, 19, 21, 21, 19, 22, 31, 25, 46, 1, 30, 3, 12, 19, 42, 37, 39, 5, 37, 6, 7, 21, 34, 39, 35, 31, 47, 41, 37, 42, 15, 27, 43, 42, 38, 35, 27, 10, 11, 12, 9, 10, 32, 34, 0, 11, 36, 17, 39, 38, 36, 31, 35, 38, 1, 38, 26, 24, 48, 3, 13, 39, 14, 0, 11, 15, 31, 45, 4, 19, 29, 41, 33, 10, 22, 33, 7, 19, 18, 7, 9, 14, 11, 6, 10, 37, 21, 38, 48, 37, 38, 23, 35, 15, 13, 17, 0, 47, 47, 28, 16, 28, 10, 26, 40, 31, 8, 6, 33, 46, 26, 26, 15, 36, 0, 20, 25, 16, 12, 37, 2, 17, 4, 24, 47, 25, 36, 31, 0, 35, 39, 37, 23, 15, 21, 27, 11, 2, 19, 36, 6, 27, 34, 5, 13, 1, 7, 37, 28, 42, 6, 26, 33, 15, 33, 18, 19, 14, 41, 2, 3, 6, 19, 26, 40, 15, 32, 40, 32, 22, 32, 40, 6, 7, 14, 37, 4, 41, 48, 46, 17, 46, 25, 31, 16, 31, 31, 18, 8, 14, 9, 21, 42, 6, 46, 38, 33, 9, 20, 18, 41, 39, 18, 9, 7, 19, 2, 40, 28, 48, 23, 28, 43, 35, 2, 1, 6, 25, 1, 6, 41, 12, 40, 33, 19, 5, 5, 13, 26, 46, 35, 0, 13, 38, 24, 44, 3, 5, 13, 31, 32, 43, 27, 19, 23, 10, 13, 11, 16, 44, 2, 37, 6, 5, 43, 41, 18, 2, 31, 20, 14, 8, 18, 1, 1, 24, 11, 38, 14, 6, 2, 29, 41, 42, 0, 40, 38, 16, 13, 39, 40, 6, 40, 11, 25, 4, 29, 28, 13, 34, 37, 33, 10, 9, 32, 40, 46, 35, 7, 45, 30, 6, 21, 39, 20, 16, 31, 17, 20, 36, 45, 29, 32, 26, 17, 12, 16, 12, 32, 8, 0, 28, 38, 7, 22, 24, 45, 34, 2, 9, 18, 22, 34, 33, 1, 18, 42, 40, 6, 38, 18, 8, 30, 7, 24, 34, 5, 25, 37, 45, 22, 35, 11, 26, 15, 29, 26, 23, 37, 20, 42, 33, 17, 6, 48, 13, 27, 13, 41, 17, 16, 10, 9, 31, 34, 29, 24, 6, 29, 29, 25, 20, 12, 35, 21, 12, 9, 2, 27, 4, 39, 42, 29, 18, 42, 32, 21, 11, 33, 2, 39, 17, 45, 36, 36, 33, 42, 19, 9, 36, 35, 33, 47, 36, 46, 13, 20, 10, 26, 25, 34, 41, 46, 45, 47, 47, 2, 13, 26, 27, 3, 24, 43, 31, 8, 18, 23, 30, 22, 0, 33, 48, 20, 6, 38, 46, 44, 19, 41, 36, 8, 24, 39, 18, 48, 28, 35, 45, 29, 39, 34, 26, 5, 11, 20, 10, 39, 21, 18, 23, 45, 38, 5, 33, 19, 2, 18, 17, 28, 3, 19, 14, 47, 46, 7, 25, 9, 22, 44, 35, 39, 22, 7, 18, 48, 19, 47, 8, 23, 14, 24, 36, 46, 9, 8, 46, 43, 12, 34, 11, 31, 14, 4, 34, 15, 15, 1, 40, 4, 22, 34, 33, 34, 18, 31, 18, 19, 19, 28, 15, 32, 5, 32, 21, 28, 31, 41, 14, 14, 41, 24, 7, 24, 4, 10, 13, 26, 23, 32, 26, 6, 44, 13, 4, 10, 16, 39, 21, 45, 37, 34, 22, 28, 32, 1, 19, 35, 23, 23, 20, 1, 0, 12, 35, 14, 41, 10, 3, 17, 47, 43, 13, 42, 31, 10, 11, 5, 34, 23, 13, 47, 29, 26, 29, 7, 40, 14, 39, 20, 19, 48, 21, 4, 42, 45, 3, 39, 47, 11, 43, 1, 44, 1, 5, 9, 14, 44, 31, 7, 10, 0, 31, 44, 8, 32, 23, 36, 20, 47, 16, 13, 34, 8, 16, 1, 44, 2, 7, 13, 20, 35, 4, 9, 0, 8, 2, 17, 26, 20, 33, 24, 41, 26, 11, 6, 11, 23, 10, 41, 3, 27, 20, 2, 26, 33, 6, 24, 42, 26, 47, 18, 43, 35, 35, 29, 25, 0, 39, 23, 26, 32, 27, 25, 16, 16, 27, 22, 0, 41, 8, 34, 0, 24, 7, 3, 22, 20, 26, 35, 2, 8, 34, 2, 10, 47, 35, 27, 44, 28, 32, 3, 37, 36, 0, 32, 7, 35, 5, 1, 15, 2, 14, 33, 12, 30, 44, 38, 12, 47, 20, 42, 13, 26, 15, 15, 46, 25, 37, 33, 41, 39, 47, 20, 42, 12, 32, 11, 31, 2, 2, 32, 45, 38, 25, 13, 30, 45, 28, 36, 42, 40, 42, 41, 39, 14, 11, 15, 39, 37, 30, 4, 44, 26, 4, 27, 47, 8, 14, 30, 39, 41, 41, 12, 26, 25, 2, 32, 34, 35, 37, 14, 28, 35, 7, 12, 0, 1, 33, 43, 8, 7, 25, 15, 8, 0, 8, 44, 29, 17, 39, 48, 38, 44, 0, 22, 39, 19, 13, 45, 45, 39, 15, 11, 14, 46, 21, 22, 3, 36, 11, 5, 17, 23, 41, 35, 16, 38, 23, 27, 13, 1, 0, 45, 3, 16, 18, 28, 24, 7, 31, 10, 26, 9, 45, 20, 23, 4, 37, 30, 43, 11, 28, 18, 35, 35, 17, 18, 33, 6, 46, 1, 25, 31, 16, 22, 29, 24, 27, 28, 15, 47, 28, 17, 48, 30, 0, 38, 29, 8, 2, 27, 3, 47, 44, 46, 36, 23, 43, 16, 8, 19, 30, 24, 22, 26, 41, 29, 1, 21, 31, 43, 33, 45, 37, 20, 9, 6, 8, 28, 34, 10, 20, 35, 27, 19, 35, 1, 1, 33, 46, 38, 45, 7, 38, 39, 27, 13, 27, 47, 15, 25, 22, 14, 23, 37, 22, 9, 4, 44, 6, 36, 27, 37, 22, 27, 28, 46, 10, 22, 13, 10, 2, 45, 6, 20, 45, 23, 46, 21, 26, 44, 22, 32, 30, 7, 3, 35, 38, 31, 33, 5, 2, 30, 1, 13, 5, 7, 26, 1, 30, 42, 21, 14, 45, 36, 2, 24, 26, 13, 4, 18, 29, 24, 23, 14, 7, 39, 23, 18, 43, 45, 37, 12, 28, 13, 19, 6, 19, 34, 38, 42, 45, 15, 36, 15, 19, 14, 6, 8, 45, 30, 38, 15, 0, 27, 35, 33, 35, 28, 10, 5, 43, 11, 21, 11, 46, 16, 28, 46, 27, 25, 5, 39, 2, 34, 35, 7, 30, 45, 31, 19, 16, 31, 40, 16, 38, 20, 32, 34, 34, 43, 28, 42, 24, 47, 13, 3, 1, 20, 18, 15, 24, 39, 13, 20, 17, 12, 16, 22, 32, 37, 44, 47, 11, 10, 7, 7, 20, 37, 20, 27, 45, 12, 42, 2, 41, 28, 37, 32, 33, 15, 43, 33, 6, 45, 26, 19, 25, 42, 2, 34, 3, 16, 2, 21, 36, 21, 40, 28, 10, 25, 26, 14, 47, 36, 20, 18, 31, 26, 4, 22, 11, 2, 3, 3, 47, 21, 36, 27, 42, 15, 12, 14, 35, 6, 38, 35, 46, 3, 10, 19, 20, 41, 39, 49));
	defineConstant("start_stop_codon_positions",matrix(c(0, 9996), ncol = 2, byrow = T));

	defineConstant("seq_length", 9999);
	get_fitness();

	sim.setValue("fixations_p1", sim.chromosome.ancestralNucleotides(format = "integer"));
	sim.setValue("fixations_counted_p1", 0);
	sim.setValue("dN_p1", 0);
	sim.setValue("dS_p1", 0);
	sim.setValue("subs_p1", "\n\nSubstitutions:");
}


function (void) get_fitness (void){
	poses = start_stop_codon_positions;

	for (row_num in (0:(nrow(start_stop_codon_positions)-1))){
		fitnesses = c();
		aas = codonsToAminoAcids(sim.chromosome.ancestralNucleotides(drop(poses[row_num,0]), drop(poses[row_num, 1])+2, "codon"), paste = F);

		sim.setValue("ancestral_aa_seq" + asString(row_num),aas); 

		count = 0;
		for (aa in aas){
			fitnesses = c(fitnesses, sim.getValue(aa)[sim.getValue("fitness_profiles" + row_num)[count]]);
			count = count + 1; 
		}

		sim.setValue("ancestral_fitnesses" + asString(row_num), fitnesses);
		sim.setValue("ancestral_fitness_value" + asString(row_num), sum(fitnesses));
		sim.setValue("ancestral_aas" + asString(row_num), aas);

	}
}


function (float) get_genome_fitness (object nucs){
	fitness_value = 0.0;
	for (row_num in (0:(nrow(start_stop_codon_positions) -1))){

		anc_fit_val =  sim.getValue("ancestral_fitness_value" + asString(row_num));

		starting_pos = drop(start_stop_codon_positions[row_num,0]);
		ending_pos = drop(start_stop_codon_positions[row_num,1])+2;
		aa_stop_pos = (ending_pos - starting_pos + 1)/3 - 1;
		aa_seq = codonsToAminoAcids(nucs.nucleotides(start = starting_pos, end = ending_pos, format = "codon"), paste = F);

		poses = (aa_seq != sim.getValue("ancestral_aas" + row_num));

		if(sum(poses) == 0){
			codon_fit = anc_fit_val;
		}
		else if(any(poses[0] | poses[aa_stop_pos])){
			codon_fit = 0;
		}
		else{
		fitness_vals = sim.getValue("ancestral_fitnesses"+row_num);
			fitness_vals[poses] = sapply(which(poses), "sim.getValue(aa_seq[applyValue])[sim.getValue(\"fitness_profiles\" + row_num)[applyValue + starting_pos]];");

			if(any(aa_seq[poses] == "X")){
				early_stop_point = which(aa_seq[poses] == "X")[0];
				fitness_vals = fitness_vals[starting_pos:early_stop_point];
			}

			codon_fit = sum(fitness_vals);
		}

		fitness_value = fitness_value + codon_fit;
	}

	return fitness_value;
}


fitnessEffect() {return((get_genome_fitness(individual.genome1)+get_genome_fitness(individual.genome2)) / 6617.675202403939);//If error says total fitness < 0.0, mutation rate is lethal
}


1688 late() {
	setup_fitness();
	sim.readFromPopulationFile("p6.txt");
	p1.setSubpopulationSize(100);

	sim.setValue("fixations_p1", codonsToNucleotides(nucleotidesToCodons(readFile("p6_fixed_mutations.txt")), format = "integer"));
	sim.setValue("fixations_counted_p1", 0);
	sim.setValue("dN_p1", 0);
	sim.setValue("dS_p1", 0);
	sim.setValue("subs_p1", "\n\nSubstitutions:");
}


1688:1688late () {
}


1689 late() {
	genomes = p1.genomes;

	for (g in genomes){
		fasta_string_nuc = "";
		fasta_string_nuc = paste0(">", g.individual, ", p7: \n", g.nucleotides());
		writeFile("/work/dk_lab/work/afarinesh/SLiM_Tree_paper_EMB/EX_3/nuc_FASTA/p7_nuc.fasta", fasta_string_nuc,append = T);
		fasta_string_prot = paste0(">", g.individual, ", p7: \n", codonsToAminoAcids(nucleotidesToCodons(g.nucleotides())));
		writeFile("/work/dk_lab/work/afarinesh/SLiM_Tree_paper_EMB/EX_3/aa_FASTA/p7_aa.fasta", fasta_string_prot,append = T);}
	writeFile("/work/dk_lab/work/afarinesh/SLiM_Tree_paper_EMB/EX_3/p7_fixed_mutations.txt", paste(codonsToNucleotides(nucleotidesToCodons(sim.getValue("fixations_p1"))), sep = ""));
	sim.outputFixedMutations();
}