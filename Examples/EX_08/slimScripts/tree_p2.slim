initialize() {
	setSeed(558673521);
	initializeSLiMOptions(nucleotideBased=T);
	initializeAncestralNucleotides("p1.fasta");
	mm = mmJukesCantor(0.0005);
	initializeMutationTypeNuc("m1", 0.5, "f", 0.0);
	m1.convertToSubstitution = F;
	initializeGenomicElementType("g1", m1, 1.0, mm);
	initializeGenomicElementType("g2", m1, 1.0, mm);
	initializeRecombinationRate(2.5e-08);
	initializeGenomicElement(g1, 0, 899);
}


function (void) setup_fitness(void){

	sim.setValue("fixations_p1", sim.chromosome.ancestralNucleotides(format = "integer"));
	sim.setValue("fixations_counted_p1", 0);
	sim.setValue("dN_p1", 0);
	sim.setValue("dS_p1", 0);
	sim.setValue("subs_p1", "\n\nSubstitutions:");
}


1001 late() {
	setup_fitness();
	sim.readFromPopulationFile("p1.txt");
	p1.setSubpopulationSize(100);

	sim.setValue("fixations_p1", codonsToNucleotides(nucleotidesToCodons(readFile("p1_fixed_mutations.txt")), format = "integer"));
	sim.setValue("fixations_counted_p1", 0);
	sim.setValue("dN_p1", 0);
	sim.setValue("dS_p1", 0);
	sim.setValue("subs_p1", "\n\nSubstitutions:");
}


1001:1086late () {
}


1087 late() {
	sim.outputFull("p2.txt");
	writeFile("p2.fasta", (">parent_ancestral_to_load\n" + sim.chromosome.ancestralNucleotides()));
	writeFile("/work/dk_lab/work/afarinesh/SLiM_Tree_paper_MBE/EX_08/p2_fixed_mutations.txt", paste(codonsToNucleotides(nucleotidesToCodons(sim.getValue("fixations_p1"))), sep = ""));
	sim.outputFixedMutations();
	system("sbatch \"/work/dk_lab/work/afarinesh/SLiM_Tree_paper_MBE/EX_08/slimScripts/tree_p3.sh\"");
	system("sbatch \"/work/dk_lab/work/afarinesh/SLiM_Tree_paper_MBE/EX_08/slimScripts/tree_p6.sh\"");
}