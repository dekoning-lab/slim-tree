initialize() {
	setSeed(791970774);
	initializeSLiMOptions(nucleotideBased=T);
	initializeAncestralNucleotides (codonsToNucleotides(c(36,38,55,44,34,49,10,52,30,44,9,62,3,8,58,12,60,12,55,48,43,38,49,20,62,48,30,54,0,16,31,50,14,20,26,10,14,12,45,17,39,24,9,19,54,20,36,16,1,47,27,16,31,57,60,50,52,47,62,48,57,29,58,23,62,6,58,62,9,17,23,45,53,58,40,31,28,29,22,51,60,21,54,28,57,34,53,19,56,60,20,58,24,58,36,29,35,47,46,47,29,8,21,11,58,24,29,24,34,52,29,59,19,4,29,28,13,34,51,10,3,34,49,12,36,49,31,34,62,3,40,10,32,4,37,17,13,29,26,37,13,6,8,34,61,58,11,18,9,50,25,18,62,10,23,29,4,4,29,33,48,1,20,33,12,48,26,10,12,53,31,17,17,55,32,55,51,37,4,51,6,21,7,48,13,33,21,34,24,57,13,17,37,0,58,44,25,28,11,30,3,15,3,2,52,14,33,60,23,47,16,51,44,9,33,4,43,4,0,38,28,53,30,50,31,19,48,50,7,61,5,6,27,38,45,39,62,26,25,45,11,62,31,16,38,8,46,25,24,14,62,55,53,14,17,27,9,38,16,57,57,0,7,13,22,6,56,37,45,21,60,28,28,14,8,14,52,6,45,51,3,51,17,0,3,31,48,57,13,4,62,15,4,17,11,43,39,36,17,7),format="char"));
	mm = mmJukesCantor(0.0005);
	initializeMutationTypeNuc("m1", 0.5, "f", 0.0);
	m1.convertToSubstitution = F;
	initializeGenomicElementType("g1", m1, 1.0, mm);
	initializeGenomicElementType("g2", m1, 1.0, mm);
	initializeRecombinationRate(2.5e-08);
	initializeGenomicElement(g1, 0, 899);
}


function (void) setup_fitness(void){

	sim.setValue("fixations_p1", sim.chromosome.ancestralNucleotides(format = "integer"));
	sim.setValue("fixations_counted_p1", 0);
	sim.setValue("dN_p1", 0);
	sim.setValue("dS_p1", 0);
	sim.setValue("subs_p1", "\n\nSubstitutions:");
}


1 late() {
	setup_fitness();
	sim.addSubpop("p1", 100);
	sim.setValue("fixations", strsplit(sim.chromosome.ancestralNucleotides(),sep = ""));
	sim.setValue("fixations_counted_p1", 0);
	sim.setValue("dN_p1", 0);
	sim.setValue("dS_p1", 0);
	sim.setValue("subs_p1", "\n\nSubstitutions:");
}


1:1000late () {
}


1001 late() {
	sim.outputFull("p1.txt");
	writeFile("p1.fasta", (">parent_ancestral_to_load\n" + sim.chromosome.ancestralNucleotides()));
	writeFile("/work/dk_lab/work/afarinesh/SLiM_Tree_paper_MBE/EX_08/p1_fixed_mutations.txt", paste(codonsToNucleotides(nucleotidesToCodons(sim.getValue("fixations_p1"))), sep = ""));
	sim.outputFixedMutations();
	system("sbatch \"/work/dk_lab/work/afarinesh/SLiM_Tree_paper_MBE/EX_08/slimScripts/tree_p2.sh\"");
	system("sbatch \"/work/dk_lab/work/afarinesh/SLiM_Tree_paper_MBE/EX_08/slimScripts/tree_p9.sh\"");
}